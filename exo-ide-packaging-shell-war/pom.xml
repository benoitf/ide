<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <artifactId>exo-ide-parent</artifactId>
        <groupId>org.exoplatform.ide</groupId>
        <version>2.12.3-SNAPSHOT</version>
    </parent>
    <artifactId>exo-ide-packaging-shell-war</artifactId>
    <packaging>war</packaging>
    <name>Codenvy IDE :: Packaging :: Shell</name>
    <dependencies>
        <dependency>
            <groupId>org.exoplatform.ide</groupId>
            <artifactId>exo-ide-framework-client</artifactId>
            <version>${project.version}</version>
        </dependency>
        <dependency>
            <groupId>org.exoplatform.ide</groupId>
            <artifactId>exo-ide-shell</artifactId>
            <version>${project.version}</version>
        </dependency>
        <dependency>
            <groupId>org.exoplatform.ide</groupId>
            <artifactId>exo-ide-vfs</artifactId>
            <version>${project.version}</version>
        </dependency>
        <dependency>
            <groupId>org.exoplatform.ide</groupId>
            <artifactId>exo-ide-vfs-fs</artifactId>
            <version>${project.version}</version>
        </dependency>
        <dependency>
            <groupId>com.google.guava</groupId>
            <artifactId>guava</artifactId>
            <version>${guava.version}</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>com.google.guava</groupId>
            <artifactId>guava-gwt</artifactId>
            <version>${guava.version}</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>com.google.gwt</groupId>
            <artifactId>gwt-user</artifactId>
            <version>${gwt.version}</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.exoplatform.ide</groupId>
            <artifactId>exo-ide-editor</artifactId>
            <version>${project.version}</version>
            <scope>provided</scope>
        </dependency>
    </dependencies>
    <build>
        <sourceDirectory>target/share</sourceDirectory>
        <resources>
            <resource>
                <directory>src/main/resources</directory>
                <excludes>
                    <exclude>**/*</exclude>
                </excludes>
            </resource>
        </resources>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-antrun-plugin</artifactId>
                <executions>
                    <execution>
                        <id>unwar-shell</id>
                        <phase>process-resources</phase>
                        <goals>
                            <goal>run</goal>
                        </goals>
                        <configuration>
                            <tasks>
                                <unwar dest="${project.build.directory}/share" src="${project.build.directory}/dependency/exo-ide-shell-${project.version}.jar" />
                            </tasks>
                        </configuration>
                    </execution>
                    <execution>
                        <id>move-compile-resources</id>
                        <phase>prepare-package</phase>
                        <goals>
                            <goal>run</goal>
                        </goals>
                        <configuration>
                            <tasks>
                                <move todir="${project.build.directory}/${project.artifactId}-${project.version}">
                                    <fileset dir="${project.build.directory}/${project.artifactId}-${project.version}/Shell" />
                                </move>
                            </tasks>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-dependency-plugin</artifactId>
                <executions>
                    <execution>
                        <id>copy-dependencies</id>
                        <phase>generate-sources</phase>
                        <goals>
                            <goal>copy</goal>
                        </goals>
                        <configuration>
                            <artifactItems>
                                <artifactItem>
                                    <groupId>org.exoplatform.ide</groupId>
                                    <artifactId>exo-ide-shell</artifactId>
                                    <version>${project.version}</version>
                                    <type>jar</type>
                                </artifactItem>
                            </artifactItems>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <configuration>
                    <skipTests>true</skipTests>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <configuration>
                    <webXml>src/main/resources/WEB-INF/web.xml</webXml>
                    <warSourceExcludes>.gwt-tmp/**,**/shell/**,**/application/**</warSourceExcludes>
                    <packagingExcludes>**/classes/org/**,
                        **/Commons.css,
                        **/hosted.html,
                        **/IDEShell.html,
                        **/lib/exo-ide-client*,
                        **/lib/exo-ide-collabeditor*,
                        **/lib/exo-ide-editor-*,
                        **/lib/exo-ide-extension-samples*,
                        **/lib/exo-ide-framework-client*,
                        **/lib/exo-ide-jdt-core*,
                        **/lib/exo-jcr-services*,
                        **/lib/exo-gwtframework*,
                        **/exo.core.component.security.core*,
                        **/lib/slf4j-log4j*,
                        **/lib/log4j*,
                        **/lib/commons-logging-api*,
                        **/lib/commons-logging*,
                        **/lib/servlet-api*,
                        **/lib/portlet-api*,
                        **/lib/bcprov-jdk15*,
                        **/lib/hsqldb.*,
                        **/lib/carol*,
                        **/lib/jacorb*,
                        **/lib/ow2*,
                        **/lib/irmi*,
                        **/lib/avalon*,
                        **/lib/logkit*,
                        **/lib/howl*,
                        **/lib/hibernate*,
                        **/lib/infinispan*,
                        **/lib/c3p0*,
                        **/lib/stax-api*,
                        **/lib/gwt-dev*,
                        **/lib/sjsxp*,
                        **/lib/*junit*,
                        **/lib/jotm*,
                        **/lib/xdoclet*,
                        **/lib/activation*,
                        **/lib/annotations-api*,
                        **/lib/sjsxp*,
                        **/lib/gwt-user*,
                        **/lib/postgresql*,
                        **/lib/tools.jar,
                        **/lib/guice-2.0.jar,
                        **/lib/antlr-2.*,
                        **/lib/xstream-1.0.2.jar</packagingExcludes>
                    <webResources>
                        <resource>
                            <directory>src/main/resources</directory>
                            <targetPath>.</targetPath>
                        </resource>
                        <resource>
                            <directory>src/main/webapp</directory>
                            <targetPath>.</targetPath>
                        </resource>
                    </webResources>
                </configuration>
            </plugin>
            <!-- configure the GWT-Maven plugin -->
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>gwt-maven-plugin</artifactId>
                <executions>
                    <execution>
                        <phase>compile</phase>
                        <goals>
                            <goal>compile</goal>
                        </goals>
                    </execution>
                </executions>
                <configuration>
                    <module>org.exoplatform.ide.shell.Shell</module>
                    <runTarget>org.exoplatform.ide.shell.Shell/Shell.html</runTarget>
                    <logLevel>INFO</logLevel>
                    <skipTests>${gwt.test.skip}</skipTests>
                    <style>${gwt.compiler.additional.options}</style>
                    <extraJvmArgs>${gwt.xmx}</extraJvmArgs>
                </configuration>
            </plugin>
        </plugins>
        <!-- outputDirectory>target/war/classes</outputDirectory -->
    </build>
</project>
